     1	      IDENTIFICATION DIVISION.							16FEB24 14:39:26  PAGE	  1
     2	      PROGRAM-ID. S.
     3	      ENVIRONMENT DIVISION.
     4	      INPUT-OUTPUT SECTION.
     5	      FILE-CONTROL.
     6            SELECT BSIT2-1 ASSIGN TO "BSIT2-1.DAT".
     7            SELECT BSIT2-2 ASSIGN TO "BSIT2-2.DAT".
     8            SELECT STUD-MGR ASSIGN TO "STUD-MGR.DAT".
     9            SELECT STUD-WRK ASSIGN TO "STUD-WRK.DAT".
    10            SELECT STUD-PRT ASSIGN TO "STUD-PRT.DAT".
    11	      DATA DIVISION.
    12	      FILE SECTION.
    13	      FD  BSIT2-1
    14		  LABEL RECORDS ARE STANDARD
    15		  DATA RECORD IS BSIT2-1-REC.
    16	      01  BSIT2-1-REC.
    17		  02 BSIT2-1-NUMBER PIC X(10).
    18		  02 BSIT2-1-NAME PIC X(25).
    19		  02 BSIT2-1-QUIZ1 PIC 9V99.
    20		  02 BSIT2-1-QUIZ2 PIC 9V99.
    21		  02 BSIT2-1-QUIZ3 PIC 9V99.
    22	      FD  BSIT2-2
    23		  LABEL RECORDS ARE STANDARD
    24		  DATA RECORD IS BSIT2-2-REC.
    25	      01  BSIT2-2-REC.
    26		  02 BSIT2-2-NUMBER PIC X(10).
    27		  02 BSIT2-2-NAME PIC X(25).
    28		  02 BSIT2-2-QUIZ1 PIC 9V99.
    29		  02 BSIT2-2-QUIZ2 PIC 9V99.
    30		  02 BSIT2-2-QUIZ3 PIC 9V99.
    31
    32	      FD  STUD-MGR
    33		  LABEL RECORDS ARE STANDARD
    34		  DATA RECORD IS STUD-MGR-REC.
    35	      01  STUD-MGR-REC.
    36		  02 STUD-MGR-NUMBER PIC X(10).
    37		  02 STUD-MGR-NAME PIC X(25).
    38		  02 STUD-MGR-QUIZ1 PIC 9V99.
    39		  02 STUD-MGR-QUIZ2 PIC 9V99.
    40		  02 STUD-MGR-QUIZ3 PIC 9V99.
    41
    42	      FD  STUD-PRT
    43		  LABEL RECORDS ARE STANDARD
    44		  DATA RECORD IS STUD-PRT-REC.
    45	      01  STUD-PRT-REC PIC X(80).
    46
    47	      SD  STUD-WRK
    48		  LABEL RECORDS ARE STANDARD
    49		  DATA RECORD IS STUD-WRK-REC.
    50	      01  STUD-WRK-REC.
    51		  02 STUD-WRK-NUMBER PIC X(10).
    52		  02 STUD-WRK-NAME PIC X(25).
    53		  02 STUD-WRK-QUIZ1 PIC 9V99.
    54		  02 STUD-WRK-QUIZ2 PIC 9V99.
    55		  02 STUD-WRK-QUIZ3 PIC 9V99.
    56
    57	      WORKING-STORAGE SECTION.
    58        01  EOF PIC X(3) VALUE "NO".
    59	      01  HDG-1.
    60		  02 FILLER PIC X(20) VALUE SPACES.    61            02 FILLER PIC X(22) VALUE "POLYTECHNIC UNIVERSITY".                   16FEB24 14:39:26  PAGE    2
    62            02 FILLER PIC X(19) VALUE " OF THE PHILIPPINES".
    63	      01  HDG-2.
    64		  02 FILLER PIC X(31) VALUE SPACES.
    65            02 FILLER PIC X(18) VALUE "QUEZON CITY CAMPUS".
    66	      01  HDG-3.
    67		  02 FILLER PIC X(30) VALUE SPACES.
    68            02 FILLER PIC X(19) VALUE "BSIT 2-1 & BSIT 2-2".
    69	      01  HDG-4.
    70		  02 FILLER PIC X(34) VALUE SPACES.
    71            02 FILLER PIC X(12) VALUE "QUIZ SUMMARY".
    72	      01  HDG-5.
    73		  02 FILLER PIC X(5) VALUE SPACES.
    74            02 FILLER PIC X(14) VALUE "STUDENT NUMBER".
    75		  02 FILLER PIC X(6) VALUE SPACES.
    76            02 FILLER PIC X(12) VALUE "STUDENT NAME".
    77		  02 FILLER PIC X(9) VALUE SPACES.
    78            02 FILLER PIC X(6) VALUE "QUIZ#1".
    79		  02 FILLER PIC X(3) VALUE SPACES.
    80            02 FILLER PIC X(6) VALUE "QUIZ#2".
    81		  02 FILLER PIC X(3) VALUE SPACES.
    82            02 FILLER PIC X(6) VALUE "QUIZ#3".
    83		  02 FILLER PIC X(3) VALUE SPACES.
    84            02 FILLER PIC X(7) VALUE "AVERAGE".
    85	      01  PRINT-LINE.
    86		  02 FILLER PIC X(6) VALUE SPACES.
    87		  02 MRG-NUMBER-OUT PIC X(10).
    88		  02 FILLER PIC X(4) VALUE SPACES.
    89		  02 MRG-NAME-OUT PIC X(25).
    90		  02 FILLER PIC X(2) VALUE SPACES.
    91		  02 MRG-QUIZ1-OUT PIC 9.99.
    92		  02 FILLER PIC X(5) VALUE SPACES.
    93		  02 MRG-QUIZ2-OUT PIC 9.99.
    94		  02 FILLER PIC X(5) VALUE SPACES.
    95		  02 MRG-QUIZ3-OUT PIC 9.99.
    96		  02 FILLER PIC X(6) VALUE SPACES.
    97		  02 MRG-AVERAGE-OUT PIC 9.99.
    98	      01  HDG-6.
    99		  02 FILLER PIC X(5) VALUE SPACES.
   100            02 FILLER PIC X(16) VALUE "PER QUIZ AVERAGE".
   101		  02 FILLER PIC X(26) VALUE SPACES.
   102		  02 AVG-QUIZ1-OUT PIC 9.99.
   103		  02 FILLER PIC X(5) VALUE SPACES.
   104		  02 AVG-QUIZ2-OUT PIC 9.99.
   105		  02 FILLER PIC X(5) VALUE SPACES.
   106		  02 AVG-QUIZ3-OUT PIC 9.99.
   107		  02 FILLER PIC X(6) VALUE SPACES.
   108		  02 AVG-AVERAGE-GRADE-OUT PIC 9.99.
   109	      01  HDG-7.
   110		  02 FILLER PIC X(5) VALUE SPACES.
   111            02 FILLER PIC X(22) VALUE "HIGHEST GRADE PER QUIZ".
   112		  02 FILLER PIC X(20) VALUE SPACES.
   113		  02 HIGHEST-QUIZ1-OUT PIC 9.99.
   114		  02 FILLER PIC X(5) VALUE SPACES.
   115		  02 HIGHEST-QUIZ2-OUT PIC 9.99.
   116		  02 FILLER PIC X(5) VALUE SPACES.
   117		  02 HIGHEST-QUIZ3-OUT PIC 9.99.
   118	      01  HDG-8.
   119		  02 FILLER PIC X(5) VALUE SPACES.
   120            02 FILLER PIC X(21) VALUE "LOWEST GRADE PER QUIZ".   121		  02 FILLER PIC X(21) VALUE SPACES.					16FEB24 14:39:26  PAGE	  3
   122		  02 LOWEST-QUIZ1-OUT PIC 9.99.
   123		  02 FILLER PIC X(5) VALUE SPACES.
   124		  02 LOWEST-QUIZ2-OUT PIC 9.99.
   125		  02 FILLER PIC X(5) VALUE SPACES.
   126		  02 LOWEST-QUIZ3-OUT PIC 9.99.
   127	      01  HDG-9.
   128		  02 FILLER PIC X(5) VALUE SPACES.
   129            02 FILLER PIC X(21) VALUE "HIGHEST GRADE AVERAGE".
   130		  02 FILLER PIC X(49) VALUE SPACES.
   131		  02 HIGHEST-AVERAGE-OUT PIC 9.99.
   132	      01  HDG-10.
   133		  02 FILLER PIC X(5) VALUE SPACES.
   134            02 FILLER PIC X(20) VALUE "LOWEST GRADE AVERAGE".
   135		  02 FILLER PIC X(50) VALUE SPACES.
   136		  02 LOWEST-AVERAGE-OUT PIC 9.99.
   137	      01  AVG-GRADE PIC 9V99.
   138	      01  TOTAL-STUD PIC 99 VALUE ZEROES.
   139	      01  SUM-QUIZ1 PIC 9999V99 VALUE ZEROES.
   140	      01  SUM-QUIZ2 PIC 9999V99 VALUE ZEROES.
   141	      01  SUM-QUIZ3 PIC 9999V99 VALUE ZEROES.
   142	      01  SUM-AVERAGE PIC 9999V99 VALUE ZEROES.
   143	      01  AVG-QUIZ1 PIC 9V99 VALUE ZEROES.
   144	      01  AVG-QUIZ2 PIC 9V99 VALUE ZEROES.
   145	      01  AVG-QUIZ3 PIC 9V99 VALUE ZEROES.
   146	      01  AVG-AVERAGE-GRADE PIC 9V99 VALUE ZEROES.
   147	      01  HIGHEST-QUIZ1 PIC 9V99 VALUE ZEROES.
   148	      01  HIGHEST-QUIZ2 PIC 9V99 VALUE ZEROES.
   149	      01  HIGHEST-QUIZ3 PIC 9V99 VALUE ZEROES.
   150	      01  LOWEST-QUIZ1 PIC 9V99 VALUE ZEROES.
   151	      01  LOWEST-QUIZ2 PIC 9V99 VALUE ZEROES.
   152	      01  LOWEST-QUIZ3 PIC 9V99 VALUE ZEROES.
   153	      01  HIGHEST-AVERAGE PIC 9V99 VALUE ZEROES.
   154	      01  LOWEST-AVERAGE PIC 9V99 VALUE ZEROES.
   155	      PROCEDURE DIVISION.
   156	      MAIN.
   157		  MERGE STUD-WRK
   158		   ON ASCENDING KEY STUD-WRK-NAME
   159		   ON DESCENDING KEY STUD-WRK-NUMBER
   160		     USING BSIT2-1, BSIT2-2
   161		     GIVING STUD-MGR.
   162		  OPEN INPUT STUD-MGR
   163		       OUTPUT STUD-PRT.
   164            READ STUD-MGR AT END MOVE "YES" TO EOF.
   165
   166		  WRITE STUD-PRT-REC FROM HDG-1 AFTER 2 LINES.
   167		  WRITE STUD-PRT-REC FROM HDG-2 AFTER 1 LINES.
   168		  WRITE STUD-PRT-REC FROM HDG-3 AFTER 1 LINES.
   169		  WRITE STUD-PRT-REC FROM HDG-4 AFTER 2 LINES.
   170		  WRITE STUD-PRT-REC FROM HDG-5 AFTER 2 LINES
   171		  MOVE SPACES TO STUD-PRT-REC.
   172
   173            PERFORM READ-RTN UNTIL EOF = "YES".
   174            IF EOF = "YES"
   175		     COMPUTE AVG-QUIZ1 = SUM-QUIZ1 / TOTAL-STUD
   176		     COMPUTE AVG-QUIZ2 = SUM-QUIZ2 / TOTAL-STUD
   177		     COMPUTE AVG-QUIZ3 = SUM-QUIZ3 / TOTAL-STUD
   178		     COMPUTE AVG-AVERAGE-GRADE = SUM-AVERAGE / TOTAL-STUD
   179		     MOVE AVG-QUIZ1 TO AVG-QUIZ1-OUT
   180		     MOVE AVG-QUIZ2 TO AVG-QUIZ2-OUT   181		     MOVE AVG-QUIZ3 TO AVG-QUIZ3-OUT					16FEB24 14:39:26  PAGE	  4
   182		     MOVE AVG-AVERAGE-GRADE TO AVG-AVERAGE-GRADE-OUT
   183		     MOVE HIGHEST-QUIZ1 TO HIGHEST-QUIZ1-OUT
   184		     MOVE HIGHEST-QUIZ2 TO HIGHEST-QUIZ2-OUT
   185		     MOVE HIGHEST-QUIZ3 TO HIGHEST-QUIZ3-OUT
   186		     MOVE LOWEST-QUIZ1 TO LOWEST-QUIZ1-OUT
   187		     MOVE LOWEST-QUIZ2 TO LOWEST-QUIZ2-OUT
   188		     MOVE LOWEST-QUIZ3 TO LOWEST-QUIZ3-OUT
   189		     MOVE HIGHEST-AVERAGE TO HIGHEST-AVERAGE-OUT
   190		     MOVE LOWEST-AVERAGE TO LOWEST-AVERAGE-OUT
   191		     WRITE STUD-PRT-REC FROM HDG-6 AFTER 2 LINES.
   192		     WRITE STUD-PRT-REC FROM HDG-7 AFTER 2 LINES.
   193		     WRITE STUD-PRT-REC FROM HDG-8 AFTER 2 LINES.
   194		     WRITE STUD-PRT-REC FROM HDG-9 AFTER 2 LINES.
   195		     WRITE STUD-PRT-REC FROM HDG-10 AFTER 2 LINES.
   196		     CLOSE STUD-MGR, STUD-PRT.
   197		  STOP RUN.
   198	      READ-RTN.
   199		  MOVE STUD-MGR-NUMBER TO MRG-NUMBER-OUT
   200		  MOVE STUD-MGR-NAME TO MRG-NAME-OUT
   201		  MOVE STUD-MGR-QUIZ1 TO MRG-QUIZ1-OUT
   202		  MOVE STUD-MGR-QUIZ2 TO MRG-QUIZ2-OUT
   203		  MOVE STUD-MGR-QUIZ3 TO MRG-QUIZ3-OUT
   204		  ADD 1 TO TOTAL-STUD
   205		  COMPUTE AVG-GRADE = (STUD-MGR-QUIZ1 + STUD-MGR-QUIZ2 +
   206		  STUD-MGR-QUIZ3) / 3
   207		  ADD STUD-MGR-QUIZ1 TO SUM-QUIZ1
   208		  ADD STUD-MGR-QUIZ2 TO SUM-QUIZ2
   209		  ADD STUD-MGR-QUIZ3 TO SUM-QUIZ3
   210		  ADD AVG-GRADE TO SUM-AVERAGE
   211		  MOVE AVG-GRADE TO MRG-AVERAGE-OUT
   212
   213		  IF HIGHEST-QUIZ1 = ZEROES AND HIGHEST-AVERAGE = ZEROES
   214		      MOVE STUD-MGR-QUIZ1 TO HIGHEST-QUIZ1
   215		      MOVE AVG-GRADE TO HIGHEST-AVERAGE
   216		  END-IF.
   217		  IF STUD-MGR-QUIZ1 < HIGHEST-QUIZ1 THEN
   218		      MOVE STUD-MGR-QUIZ1 TO HIGHEST-QUIZ1
   219		  END-IF.
   220		  IF HIGHEST-QUIZ2 = ZEROES
   221		      MOVE STUD-MGR-QUIZ2 TO HIGHEST-QUIZ2
   222		  END-IF
   223		  IF STUD-MGR-QUIZ2 < HIGHEST-QUIZ2 THEN
   224		      MOVE STUD-MGR-QUIZ2 TO HIGHEST-QUIZ2
   225		  END-IF.
   226		  IF HIGHEST-QUIZ3 = ZEROES
   227		      MOVE STUD-MGR-QUIZ3 TO HIGHEST-QUIZ3
   228		  END-IF
   229		  IF STUD-MGR-QUIZ3 < HIGHEST-QUIZ3 THEN
   230		      MOVE STUD-MGR-QUIZ3 TO HIGHEST-QUIZ3
   231		  END-IF.
   232		  IF STUD-MGR-QUIZ1 > LOWEST-QUIZ1 THEN
   233		      MOVE STUD-MGR-QUIZ1 TO LOWEST-QUIZ1
   234		  END-IF.
   235		  IF STUD-MGR-QUIZ2 > LOWEST-QUIZ2 THEN
   236		      MOVE STUD-MGR-QUIZ2 TO LOWEST-QUIZ2
   237		  END-IF.
   238		  IF STUD-MGR-QUIZ3 > LOWEST-QUIZ3 THEN
   239		      MOVE STUD-MGR-QUIZ3 TO LOWEST-QUIZ3
   240		  END-IF.   241		  IF AVG-GRADE < HIGHEST-AVERAGE THEN					16FEB24 14:39:26  PAGE	  5
   242		      MOVE AVG-GRADE TO HIGHEST-AVERAGE
   243		  END-IF.
   244		  IF AVG-GRADE > LOWEST-AVERAGE THEN
   245		      MOVE AVG-GRADE TO LOWEST-AVERAGE
   246		  END-IF.
   247
   248		  WRITE STUD-PRT-REC FROM PRINT-LINE.
   249            READ STUD-MGR AT END MOVE "YES" TO EOF.Realia COBOL Version 4.000   SN: 01-07732  C:NUMBER2.COB				16FEB24 14:39:26  PAGE	  6



				    Segment Table
			Segment    Number     Length	    Name

			  C00	     05        0683	 S$C00
			  D00	     06        07AB	 S$D00


			Realia COBOL Compiler Version Information

			      Pass 1	 Version 4.059
			      Pass 1a	 Version 4.025
			      Pass 2	 Version 4.059
			      Pass 2a	 Version 4.024
			      Pass 3	 Version 4.083
			      Pass 4	 Version 4.028


			Compilation Directives in Effect

				    COMP-4
				    NODCHK
				      OPT
				    NOCALL
				    NOSUBCHK
				      STRCHK
				      ANSITRUNC
				    NOSMALLCOMP
				    NODCALL
				    NODIVZERO
				    NOEPDCALL
				      APOST
				      ASCII
				      STATABORT
				      MOVELINK
				    NOBLL4K
				      ARGCHK
				      UPLOW
				      WRITEAFTER
				      SOSI
				      DIALECT-REALIA4

				    ERROR LEVEL LIMIT: W

			Source lines compiled:	     249
			Compilation time (mm:ss.hh):  0:02.20
			Compilation speed (lines/minute):  6790

			Compilation date (yy/mm/dd): 24/02/16
			     Time of day (hh:mm:ss): 14:39:27

			Source length in LST file:000010817